#include "param.h"
#include "poly.h"

#if MITAKA_D == 512

/* Precomputed SK for speed testing */
double precomp_b10[MITAKA_D] = {-5, -2, -7, 4, -2, 1, 1, 4, -3, -1, 8, 9, -1, -3, 2, 0, 0, -1, -4, 2, 4, 2, -2, 2, 1, 1, -5, -3, -5, 1, 0, 1, 2, 0, 7, -2, 1, 3, 2, 5, -1, 2, -6, -1, 3, 0, -2, 5, -6, 0, 6, 0, -4, -3, -4, 2, 0, -4, -6, -3, -2, 3, -6, -2, 4, 1, 0, -3, -3, 5, 1, -4, -1, 5, 5, -5, -1, 3, -1, -2, 0, 3, 0, -2, -4, -5, -2, -4, 1, -1, 2, 0, 4, -3, 6, 5, 5, 2, -4, -2, 3, -1, 6, -6, -4, -5, 0, 3, 4, 3, 1, -7, 1, -6, 1, -1, 0, -4, 6, -3, 0, -3, 0, -3, 7, 2, -9, 1, 0, -1, -5, 0, 2, -4, 4, 4, -5, -3, -6, -3, 0, 2, -4, -4, -4, 0, -1, -2, -6, -1, 7, 6, 1, -2, 9, 4, 0, 0, -3, 4, -4, 2, 5, 1, 1, -3, 1, 7, -2, -9, 1, -8, 6, -4, 1, -10, 0, 3, 0, 2, 1, 0, -2, 7, -5, -3, -1, 0, -2, 5, -4, 0, -2, 0, 4, -4, -2, 7, -6, -2, -4, 1, 7, 3, -1, -1, 8, -6, -4, 2, -2, 1, 0, 3, 3, -1, 0, 2, 4, -6, -1, -4, -1, 1, 2, -5, 10, 1, -4, 0, -2, -11, 5, 5, -1, 3, 6, 0, -6, 0, 6, -8, 1, -2, -3, 8, 6, -4, 9, -4, 7, -4, 1, 2, -2, -1, 4, -5, 1, 4, 6, -3, 3, -7, 3, -10, 1, -7, 2, 2, -1, -2, -2, -3, -4, 4, -2, -3, -4, 2, -4, -4, -7, -6, 1, 4, -4, 7, -10, -2, 0, -5, 2, -8, 0, 2, 2, -1, 3, 2, 5, 0, 0, -3, 0, -4, 5, 3, -1, 1, -2, -1, -3, 6, -1, 0, 2, 3, -8, 2, -5, -3, 1, 2, -8, -1, -6, 1, 3, -5, -1, -7, -7, -6, -1, 8, 2, 7, 6, 2, 9, -7, 0, -4, -1, -2, 0, 0, -1, -1, -7, -3, -4, 5, 4, -2, -1, 8, 2, 0, -6, 5, 0, -4, -9, 0, -2, 0, -2, 3, -4, 4, -2, 2, 1, 3, 6, 4, 3, 2, 0, 3, 0, -1, 1, 5, -1, -5, 3, -1, 3, 1, -1, -8, -1, 1, -2, -1, -3, 6, -7, -4, 6, -5, 2, -5, 1, -1, 6, 5, -1, 1, 3, 0, 0, 1, 7, 4, 8, -4, 2, -8, 1, 3, -5, -4, 0, -2, 0, 1, -3, 3, 6, -1, -4, 4, -6, -2, 4, -1, 1, -3, 0, -7, 0, 3, 3, 3, 4, -2, 0, 0, -4, 2, 4, -6, -3, 0, 1, 1, 0, -4, -9, -2, -2, -2, -4, 4, -2, -6, -1, 1, 1, -6, 2, -10, 4, 11, -2, -2, 1, 5, 9, -3, -3, -4, -6, 6, -3, 1, -2, -3, 11, 7, -2, -4, -6, 5, 1, 3, 4, 7, 0, 2, 8, 1, -2, 4, 8, 5, 1, -2};

double precomp_b11[MITAKA_D] = {1, 3, 3, -4, -6, -5, 4, 5, 3, 9, 2, -5, 3, -2, 5, -3, 10, 2, -3, 0, -5, 10, 0, 10, 2, 1, 1, 6, 3, 3, 1, -8, 0, -2, -1, 5, -5, -3, 2, -5, -3, 1, -4, 6, -2, 1, -2, -8, 4, -1, 2, 5, 2, -7, 1, 6, -2, 0, -4, -8, -1, -3, -2, 2, 1, -2, -4, 5, -8, 0, -4, 0, 1, -3, 2, 7, 2, 3, -6, -8, 1, 0, -1, 2, -5, -2, 6, 0, 9, 3, -5, -2, -2, -2, -2, 2, 1, 4, 2, -6, -8, -10, 2, 6, 1, -5, -1, 1, 7, 4, -6, -2, 5, -7, 7, -4, 7, -3, -2, 1, 2, 4, 5, 2, 2, -3, -2, 4, -2, 0, -5, -1, 0, -6, 2, 3, -4, -6, -7, 4, 0, -7, -1, -1, 10, 3, 4, 3, 0, -9, 1, 1, 1, 5, -2, -1, -1, -10, 1, 4, 4, 4, -6, -4, 2, 5, -4, -3, 1, -2, 2, 1, -3, 3, -1, -1, 0, -2, -2, -1, -6, 5, -8, -6, 1, -2, -1, 3, -1, 7, -6, 1, 0, 2, 1, 0, -2, 7, 5, 5, 6, 7, -4, 4, 2, -4, 5, -6, -3, -1, -3, 2, 1, 2, 4, 1, 7, -1, 2, 7, -4, -1, 2, -2, -2, 3, -6, -6, 1, 6, 1, 3, -3, 6, -7, 6, -4, -2, -3, 5, -5, -3, 1, 4, 6, -5, 8, 0, -2, -2, 0, -3, -3, -6, 3, -3, 1, -4, -3, 3, 6, 9, -7, -1, -2, -8, -6, 2, 4, -3, 6, -4, 1, 7, -8, 4, 4, 1, -7, 6, 3, 0, 2, 8, 3, 0, 1, 3, -6, 6, -2, 2, -8, -3, -5, 4, -2, 1, -6, -4, 1, 1, 0, 3, 0, -2, 4, -1, -3, -1, 8, 10, 2, 5, 0, -9, 3, 0, -3, -1, -1, -7, -3, 0, 0, -2, 1, -1, 9, 0, 2, 2, 2, 4, 1, 0, -3, -1, 2, -1, -5, -2, 4, -6, 1, -8, 6, -8, -5, 4, -5, 4, 0, -10, 6, 5, 0, -1, 3, -3, -6, 1, 1, 1, 0, 6, 5, -2, -5, 2, 5, -9, 3, -1, -3, 4, -3, 2, -5, 6, 5, -3, -2, 0, 0, 3, -3, -1, 0, 3, -1, -3, -7, 3, 3, -4, 0, -3, 2, -1, -3, -1, 4, 5, -1, 1, -7, -1, 7, 2, -2, 3, -1, 0, -10, -1, -8, 2, -4, 0, 0, -4, -7, 2, 1, -3, -5, 2, 2, 5, -4, -3, 0, -2, 0, 5, 1, 1, 2, 3, 0, 0, -3, 10, 1, 7, 4, -6, -3, 0, 1, 4, -5, -4, -4, 2, 0, 5, 0, 0, 0, 0, -1, -1, 2, -5, 3, 1, 5, 1, 0, 5, 1, 4, -4, -5, 1, 2, 0, 1, 7, 9, -7, 5, -5, -3, 5, -5, 4, 3, 2, 1, 5, -5, 5, 8, -4, 1, -1, -5, -3, 2, -3, -2, 0, 2, 3, 0, 2, 0, -2, -6};

double precomp_b20[MITAKA_D] = {-8, -45, -2, 15, -14, -18, 7, -3, -9, 33, 29, -9, -19, 3, -5, -21, 45, -41, -19, 10, -21, 12, -13, 10, 2, -32, 69, -32, 5, 21, -39, -11, 18, 51, -19, 2, 4, -19, -21, 21, 13, 5, 26, 23, -31, -13, -11, 31, -32, 18, -28, 10, 13, -6, 3, 16, -20, -10, 7, 35, -12, 20, -25, 64, -29, 13, 23, -10, 0, 15, 12, 67, -23, 41, 21, 22, 18, -43, -57, -8, -15, -6, 31, 2, 23, 7, -6, -27, 17, -29, -9, -2, 25, -2, -5, -3, 35, -27, 4, -47, 10, -5, 17, 30, 7, -74, -11, 19, 7, 0, -45, -4, -23, -3, -3, -38, 3, -8, -16, 17, -24, -35, -43, -26, -18, 25, -55, 20, -8, 1, -5, -44, -1, 8, 31, -19, -23, -24, 12, -51, 29, -67, -5, 14, 25, 12, -5, 28, 14, 44, 36, -43, 39, -30, 29, 7, -15, 25, 1, -17, 5, 20, -2, -28, 6, -11, 31, -27, 20, -40, 24, -5, 54, -40, 34, -25, 15, -8, 6, -68, -7, -16, 24, 2, 23, 4, -9, 15, 33, 36, -48, -6, -7, 17, 15, -4, -11, -18, -3, 60, -38, 27, 14, 17, 1, 43, 5, -20, 42, 31, 0, 28, -44, -24, 22, 23, -23, -10, 1, 15, 29, 5, -57, -47, -41, 17, 21, -32, 34, -18, -14, 21, 24, -22, -62, 32, -5, 12, -3, 44, -7, 40, 42, -17, 16, 2, -14, 40, -21, -14, 34, -4, 3, 0, -21, 6, -25, -57, 29, 3, 8, -49, -8, 15, 11, 17, 27, -38, 51, -16, 12, -26, -17, 24, -15, -17, 28, -20, -25, 38, 42, -30, 34, -33, -21, -8, -20, -14, 19, 2, -46, -14, 20, -36, 14, -15, 34, -1, 13, -23, -2, 3, 0, 7, 9, -12, 40, -54, -28, 16, -14, 31, 13, 13, -5, -1, -5, -42, 13, -1, -6, 23, -10, 2, 8, 3, 30, 37, 10, 1, -3, 39, -25, 2, -15, 1, 5, 16, -10, -1, 22, -2, -3, -7, -20, -20, -46, 1, 46, 1, 45, 14, -7, -5, 38, 11, 16, 22, 36, 16, 17, 84, -30, -24, -13, -5, 22, 18, -27, 3, 15, -6, 22, 4, -10, -10, -47, 14, -18, -22, -5, 12, -15, 34, -7, 3, -30, 29, -4, -24, 6, 11, 44, -12, -7, -43, 48, 4, 9, -28, -1, -5, -42, -41, 25, -42, 27, -28, 4, 12, -15, 20, -35, 22, 34, -32, -3, 57, 11, -2, 11, 37, 29, 14, 40, -49, 39, 33, 46, -26, -15, 7, 2, -37, 22, -38, 16, 17, 23, -9, -19, -5, -44, 3, -15, -3, 8, -25, 30, -20, 31, 63, -37, 8, -9, 7, -25, -12, 25, -9, 34, -8, -21, -32, 8, -4, -56, 12, 18, -30, 7, 17, -27, -8, -32, -53, 7, -34, 11, -14, 13, -16, 22, 19, 20, 2, 24, 37, -34, 30, 37, 16, 6, -25, 43, -4, 2, -6, -2, 43, 5, -54, -8, 24, -4, 32, 13, 28, -22, 0, -2, 4};

double precomp_b21[MITAKA_D] = {-13, 38, 28, -28, -12, -43, 24, -18, -8, 7, 14, 59, 5, -11, -8, 3, 31, 22, 59, -1, -24, 4, 13, 22, 1, -9, 24, 62, 29, 17, -14, -38, 30, 33, 2, -15, 42, -31, 25, -3, -14, 3, -39, 40, -4, -6, 36, 0, -12, -19, 29, -1, -36, 12, -5, 46, -25, -24, 12, 9, 22, 55, 0, 0, 8, -26, 40, 12, -11, 47, -9, -14, 20, -26, 5, -43, -23, 6, -38, -42, 4, -37, -7, -34, -50, 18, -2, -37, -4, -34, 21, -20, 37, -20, -10, -13, -17, -25, 9, 10, 9, -29, 4, 4, -39, -17, 9, -8, 10, 2, 17, -12, -29, 30, -20, 13, -27, 32, -20, -20, 28, -21, -20, 50, 7, 41, -35, 1, 9, 17, -2, 23, -13, 3, 39, -27, 17, 41, 32, 68, -8, 54, -15, 26, 7, 39, 18, -19, 7, -15, -24, 61, -41, -2, -43, -14, 22, -14, 33, -38, 3, 21, -4, 16, 4, -11, 30, -10, 18, -10, 10, -30, 8, 2, -19, -8, -2, -2, -13, -29, 26, -25, -4, -41, -5, 14, -17, 2, 2, -38, -8, -21, 4, -34, 36, 8, -2, 9, -13, 75, -23, -9, -14, 5, 8, -11, -9, 12, -27, -8, -35, 6, 30, -17, -40, 5, -12, -9, 7, -7, 36, 63, -17, 19, 19, 5, 32, 8, -20, 35, 4, -46, 63, -18, 7, 1, 12, 33, -22, -2, -10, -8, -6, 23, 10, -14, 31, -23, -16, -2, -34, 9, 0, 56, 9, 46, -17, -8, 12, -22, -35, 0, -40, 19, -7, -10, 32, -32, 12, 15, 8, 2, -9, 6, 21, -29, 9, 30, 15, 8, 8, 13, -27, 18, -27, 25, 20, -43, -9, -15, -33, 16, 20, 14, -56, 24, -23, 11, 32, -12, -13, -38, 23, -3, -9, 10, 7, -17, 11, 27, -18, 2, 25, -17, -17, -9, 11, 38, -15, 20, -20, -8, 9, 40, -1, 44, -10, -29, 1, 39, 1, -56, 9, -20, -25, -6, -24, 44, -38, 39, 12, -17, 6, 20, -7, -5, -4, 13, 3, 11, -29, -2, -26, 39, 3, 2, -51, -32, -20, -6, -20, 33, -34, -14, -25, 19, -64, -23, -2, 8, 33, -15, 8, -67, 9, -17, 22, 16, -14, -10, 28, 40, -45, 39, 24, 10, 49, -27, 5, 14, 8, 5, 11, 34, -16, -14, 17, -12, -1, -19, -16, -27, 1, 16, 9, 37, -11, 27, 28, -2, -28, 24, -10, -20, 34, -15, -37, 32, -6, 23, 16, 6, 0, -25, 8, 38, -17, -34, 51, -29, -4, 14, 14, 7, 40, -23, -20, 35, -4, 21, 22, -14, 11, -52, -47, 34, 32, -12, -41, 11, 56, -14, -1, -2, 6, 36, -15, -11, 21, -24, -15, 60, 13, 45, -26, 14, -84, 25, -47, -65, 62, -21, 10, 4, -31, 31, -2, 23, -23, 27, -9, 16, -21, 32, 33, -11, -11, 41, -6, 0, 27, 52, -47, 38, -2, 7, 24, -44, 68, -36, 6, 6, -8, 44, 8, 26, -1, -20, -20, 14, 43, 3};


/* Precomputed corresponding PK */
double precomp_h[MITAKA_D] = {8176, 5624, 10194, 3789, 7977, 8146, 8449, 2880, 8100, 5176, 693, 8752, 1351, 577, 7384, 2992, 3057, 11259, 7942, 6263, 6249, 5490, 9456, 2355, 4387, 12065, 711, 8392, 7373, 572, 6497, 4494, 7017, 1982, 2099, 10751, 10052, 3900, 11462, 1070, 6320, 3821, 1918, 10264, 12209, 1650, 8071, 11712, 5923, 12238, 3650, 7845, 9951, 8017, 9886, 3001, 5146, 5705, 2925, 11010, 8297, 2937, 3797, 11319, 910, 7909, 10078, 1633, 9055, 315, 9960, 7919, 6384, 5447, 1758, 9893, 4858, 9707, 10283, 8943, 9061, 6131, 9381, 3862, 9055, 10270, 9187, 1344, 200, 4770, 2564, 2244, 8817, 9407, 11432, 9001, 9871, 7962, 6357, 1293, 2105, 2037, 7873, 10784, 1060, 10971, 4432, 5750, 3492, 8822, 9516, 5120, 1966, 57, 245, 445, 9283, 3449, 4737, 1496, 6473, 7026, 10002, 7340, 9353, 5723, 10577, 5436, 4310, 9192, 452, 6824, 6430, 10173, 9998, 2035, 9579, 1525, 3749, 9255, 12269, 3052, 4821, 11880, 10498, 11746, 1982, 10668, 2166, 9745, 5814, 11822, 1650, 1976, 7955, 8082, 9102, 7572, 2350, 8005, 10898, 4806, 2694, 11876, 5347, 5621, 733, 4690, 1380, 480, 1776, 6674, 5538, 11720, 6572, 10995, 3104, 4319, 10154, 3435, 11417, 2521, 6581, 11388, 11771, 868, 670, 10018, 7205, 8312, 5798, 5311, 7389, 1133, 12081, 12250, 9382, 3679, 12147, 7538, 9565, 3150, 12050, 3361, 2097, 3473, 7771, 10353, 5102, 5825, 11702, 3107, 10426, 5130, 7555, 5351, 4058, 4010, 10029, 11191, 10597, 4692, 10435, 10314, 2929, 7052, 294, 12073, 1684, 636, 5695, 7304, 726, 8540, 303, 7364, 1041, 2862, 6635, 10105, 12262, 5005, 7217, 11171, 708, 7571, 9587, 11663, 8364, 10849, 575, 556, 8442, 9048, 10897, 1779, 11650, 100, 8901, 6574, 6838, 5129, 447, 9445, 9707, 57, 11374, 7938, 9985, 8006, 1417, 4210, 8067, 1681, 7814, 10343, 7078, 2446, 864, 3429, 11075, 8033, 8908, 5476, 4011, 7153, 1413, 10014, 10852, 8570, 4556, 3337, 8580, 5635, 9519, 4601, 7243, 331, 2784, 10452, 3966, 2319, 11582, 5366, 219, 7108, 3998, 2534, 7752, 8559, 10491, 3346, 2202, 10546, 9948, 6329, 7423, 1037, 6279, 1683, 11318, 10045, 2736, 10164, 1013, 1095, 9946, 7622, 10604, 766, 7503, 3485, 1138, 11716, 9751, 2233, 4123, 11799, 12047, 2620, 4975, 10842, 7534, 7953, 11114, 9331, 9606, 8082, 7785, 9146, 7963, 11753, 8348, 8578, 1491, 7697, 10318, 8274, 7419, 5100, 1505, 12037, 847, 8428, 7595, 9033, 11400, 1576, 3513, 2383, 2012, 1362, 2631, 1703, 7400, 6005, 10998, 5198, 1348, 73, 3183, 4532, 11724, 6684, 6374, 6574, 554, 3868, 1643, 11803, 6958, 5160, 4707, 10327, 8106, 12007, 12258, 4245, 6517, 6075, 3163, 11786, 1919, 3516, 3745, 10715, 5351, 2914, 1161, 2978, 8478, 9878, 8422, 8228, 10822, 9699, 4443, 10216, 3494, 2811, 4583, 11710, 3008, 1420, 4886, 893, 11194, 11217, 9200, 11902, 4942, 1333, 9081, 8731, 484, 10902, 2250, 7636, 6360, 11460, 98, 11368, 11217, 2563, 9631, 224, 12026, 8037, 2937, 2464, 9235, 10038, 4683, 1578, 10570, 9236, 7078, 5845, 9006, 5239, 1006, 7752, 1578, 5925, 1144, 2210, 3606, 8698, 2629, 7606, 425, 7857, 8952, 12110, 6928, 726, 547, 2062, 11239, 9627, 12083, 6518, 8042, 7328, 6815, 3778, 6430, 5218, 11272, 1599, 7836, 7636, 7048, 7661, 9747, 6467, 7222, 8789, 5093, 4029, 11590, 2614, 6278, 963, 8740, 3521, 9735, 9006, 985, 6606, 1187, 8651};

#elif MITAKA_D == 1024

/* Precomputed SK for speed testing */
double precomp_b10[MITAKA_D] = {-3, -1, 2, 3, -2, 2, -5, -3, -5, 0, -1, -3, 1, 9, -4, -4, 1, -5, 0, 3, -3, 2, 0, -2, -3, 2, -3, -1, 1, -4, 1, 0, 0, 5, -4, -7, 5, 1, 0, 5, 2, 0, -5, -2, 4, -2, -1, -3, -4, 7, 6, 2, 3, 1, 2, 0, -3, 3, -2, 0, 0, 0, 2, 5, -6, 3, -1, 6, 0, 4, -3, -2, 4, 1, 5, 4, -1, -1, 0, -2, -7, 1, 4, -3, 0, 5, 3, 5, 0, 2, 2, -1, -2, -6, -1, 0, 3, 3, -2, 1, 0, -3, 2, -2, 1, 3, 0, -2, 2, 2, -5, 4, -3, -4, 1, 3, 1, 3, 3, 0, 2, 2, -6, -1, 4, 3, 0, 5, 0, -4, -4, 4, 2, -3, 1, -1, 2, 3, 1, 1, 2, 4, -5, 0, 5, 0, 6, 1, -5, 1, 3, 5, 0, 0, 2, 2, -6, 2, -2, -5, -3, -2, -3, -1, -2, 2, 3, 2, 6, 6, 5, -4, -1, 1, 4, -1, -3, 4, -2, 3, -1, 0, -2, 2, 3, -1, 1, -7, 4, 0, 3, -6, 2, 2, 3, 1, 2, -3, -2, 1, 0, 2, 2, 8, 1, -3, 4, 4, -1, 9, -3, 5, -4, 2, 2, 1, -1, -2, -3, 0, -3, 1, -2, 2, 3, -2, -1, -2, 0, 4, 3, -2, 0, -1, -3, 5, -5, 0, -2, -7, 1, 1, 1, 3, 2, 6, 3, -4, -2, -1, 0, 3, 0, 3, 0, 0, -2, -1, -1, -1, 1, -2, -2, 3, -5, 0, -5, -1, 3, 0, -4, 4, 3, 3, 2, 0, 1, -4, 1, 1, -3, 1, -2, 0, 3, -1, 5, 0, 5, -2, -1, 1, 1, -2, 2, 3, 0, -3, 4, 2, 2, 0, 2, -3, 1, -2, 2, 6, 2, 3, -2, 6, -3, 2, 0, 4, -2, -2, 0, -2, -2, -7, -3, 2, -4, -2, 0, -3, 1, 4, 5, -3, 0, -5, 0, 2, -2, -7, 4, 0, -4, -2, 0, 0, -6, 1, 1, 3, -2, -4, -1, 4, -2, -1, 3, 2, -1, -1, -2, 0, -1, 0, 1, -3, 2, 1, -1, 2, 1, 3, 0, -4, -2, -2, 4, 5, 0, 2, -3, 4, -2, 6, -1, 0, 5, 1, -5, 1, 2, 1, -1, -1, 1, 1, 1, 1, -4, 1, -2, 1, -5, 3, -4, -4, -1, 2, 0, 0, 3, -3, -3, 2, -7, 1, 1, 3, -2, -1, 3, 1, 1, -2, -2, -3, 4, -2, -1, 3, 2, 1, -4, -1, 2, 0, 4, 3, 2, 3, -5, -2, 0, -2, 1, -3, -2, 0, 1, 1, 2, 4, -2, 0, 4, 5, 0, 3, 0, 0, 0, -5, 0, -4, -6, 2, 2, 0, 1, 1, -5, 2, -2, 1, 1, -2, 3, 2, 5, 5, -2, -1, 3, 4, 1, 2, 2, -3, 1, 1, 0, -5, -1, -1, -3, 4, 3, 2, -4, -1, -4, -5, 5, -2, 1, 2, 1, 4, 5, 6, 1, 3, -3, 4, 3, -1, 0, -1, -2, -1, -3, 3, 0, 5, 0, 0, -3, -4, 1, 7, 1, 2, -2, -5, -5, 5, 4, -5, -1, -3, 0, 8, -1, -1, -1, -1, -1, 3, -2, -4, -5, -1, 0, 0, 0, -1, -2, -1, -5, -1, 0, -1, 3, 6, 1, 2, -2, -2, -2, 4, -2, 1, 0, 4, -4, 0, 1, -8, -1, 0, -2, 5, 1, 1, 1, -1, -3, -1, -1, 3, 3, -2, 0, 0, -6, 1, -2, 4, 0, -5, 0, 2, -2, 3, -3, 1, -2, 3, -3, 2, -3, 0, 2, 2, 0, -1, 2, -1, -1, 0, -2, 5, 2, -3, -2, 2, -3, -7, 3, -4, -2, 0, 6, 2, 0, -4, 3, -1, -3, 0, 0, 1, 1, -1, 5, -6, -2, 1, 0, 1, -3, 1, -1, -2, 2, 0, 4, 1, 1, 2, 3, 1, -3, 1, 0, 0, -3, 3, -3, -1, -1, 0, 2, 1, -4, -1, -4, 5, 1, -6, -2, -2, -2, 6, 3, 2, -3, -3, -4, -1, -1, -1, -1, -3, 1, -1, 4, -4, -4, 3, -3, -4, 1, -3, 1, 1, 2, 1, -1, 7, -1, 2, -2, -2, -1, -2, 1, -2, -2, 1, 2, -1, 4, -3, 0, -1, -6, -1, 0, 3, 0, 2, 1, -3, 0, -2, -2, 0, 3, 3, 0, 0, 1, -3, -4, 2, 1, 1, -2, -1, 7, -3, -3, -2, 7, -1, 3, -5, -2, 1, 1, -6, -2, 0, -3, 5, -2, -2, -3, -5, -1, -2, -5, -1, -4, 3, -6, -2, -3, 6, 1, 0, -1, 1, -2, -1, -1, 4, -2, 2, 3, -3, 1, 0, 2, 0, -1, -1, -2, 2, 2, -2, 1, -2, -1, 4, -7, -3, -1, 0, 0, 1, -4, 3, -1, 3, -2, -1, -1, -5, 4, 2, 4, 5, 0, 0, 6, 1, 0, 2, -1, -4, 5, -2, -1, 4, 2, -3, -1, 0, -3, -7, -1, -1, 2, -4, 0, -4, -1, -1, 4, -1, -2, 2, 5, 1, -4, 5, -1, 3, -1, -5, 0, 3, 7, 0, -2, 0, 5, -4, -5, 4, -4, 2, 0, 3, -2, 3, -2, -2, 1, 7, -4, -2, -3, 7, 0, 1, -1, 0, 1, 4, 2, -2, -2, 1, -1, 3, 3, -1, -2, 0, -5, -3, 0, 1, 0, -1, -4, 1, 5, 3, 3, 6, -6, 1, -2, 2, 7, -1, -6, -2, -5, 2, -3, 2, -2, -1, -2, -5, 3, 0, 1, -1, -4, -1, -3, 0, 1, 6, -1, 4, -2, -2, 1, 2, -1, 5, -3, 0, -5, 1, 1, -2, 3, -1, 1, 1, 0, -3, 0, 1, 3, 2, 0, -1, 3, -5, -2, 5, 4, 0, -2, -1, 4, -3, -2, 2, -2, 0, -2, 9, 1, -1, 6, -1, -2, 0, 2, 2, -3, 0, -5, 3, -2, 0, 2, 3, -4, 3, -3, -1, 2, 0, 2, 0, -1, 3, -3, 1, 0, -6, 4, -6, -1, -3, -3, 3, -4, -3, 0, 5, -3, -1, 3, -2};

double precomp_b11[MITAKA_D] = {-3, -2, 0, -4, 3, 1, 4, 0, -5, -2, 1, 9, -5, 0, -1, -3, -1, -3, 3, -2, -7, 0, -3, 3, 10, -4, 2, -4, 4, -2, -1, -2, 1, -2, 2, -1, 3, -2, 0, 4, 0, -1, -3, -5, 0, -1, 1, -3, -1, -1, -1, 1, 2, -1, 1, -6, 0, 4, 0, 4, -2, 3, 4, 2, -1, -2, -2, 3, 2, -2, -2, -2, -2, -1, 3, 1, -1, 0, 0, 6, 2, 0, 5, -3, 5, 6, 1, 0, 1, -1, 1, 6, 0, 0, -2, -1, 0, -1, 1, -3, -2, 0, 1, 2, 2, 1, -1, 0, -1, 1, -5, 0, 2, 0, -1, 3, -1, 3, 1, -1, -1, 4, -4, 3, -2, 3, 4, 2, 2, 2, 6, -1, 0, -1, -4, 1, -4, 2, -2, 1, -1, 5, 0, 1, 7, -2, 0, 4, 6, -3, -1, -1, -1, 1, -4, -4, 1, 4, -4, 0, 1, 1, 5, -2, 2, -2, -4, 0, 0, 1, 0, 1, 2, 0, -1, 6, 2, 2, -1, -5, -1, 3, 2, -1, 1, 1, 1, -2, -1, -2, 2, 6, -2, 3, 1, 1, 2, -2, 3, -3, 3, 3, 0, 0, 2, 3, 6, 2, -5, 3, 0, 1, 4, 0, -2, -1, 0, -1, 3, 2, 0, 6, -1, 1, 1, 1, 1, 2, 5, 3, -1, 2, -1, -2, -2, 2, -4, -3, -1, 4, 5, -3, 0, -1, 0, 1, -2, 1, 3, -4, -5, 1, -1, 3, -8, -3, 2, 2, -3, 1, -4, -3, -4, 4, -4, 0, -1, 0, 3, -4, 2, 4, -3, -2, 1, -3, 0, -5, 2, -4, 1, -1, 2, 3, 4, 0, -3, -3, 2, 0, -2, 8, 5, 2, -4, 0, 0, -2, 4, 1, 1, 1, 2, -5, 1, 5, -4, 0, -2, -3, -5, 6, 5, 0, 4, 2, 2, 0, -4, 0, 1, 0, -2, 0, 2, 2, -2, 0, -1, -1, 5, -1, 5, -3, 4, 0, 0, 2, -1, 4, 0, 0, 0, 6, -1, 0, -5, -3, 0, 5, -2, -2, -1, -6, -1, 4, 0, -2, 3, -5, 2, 3, -4, 2, -3, -1, 1, 4, 4, -2, -3, 2, -6, 2, 2, 2, -5, 2, 1, 2, 1, 3, -5, 1, 2, 2, 2, -1, -3, -1, 2, 1, -2, -1, 3, -2, 1, 1, 4, 0, 3, -4, -6, 0, -4, 4, -1, 0, 3, 1, 1, 1, 0, 6, -2, -1, 2, -8, -1, -4, -1, -2, -1, -1, 0, -1, -4, 2, 0, 0, -1, 2, -1, 2, 1, 1, 3, 1, -1, 1, 3, -3, 3, -4, 4, 6, -2, -2, 5, 0, -2, -2, 2, -1, -2, 2, 4, -2, 2, 0, 0, 0, 4, -1, 1, 1, 1, 1, 0, -3, -1, 0, 3, 6, -3, 0, -1, 5, -4, 1, 0, -1, 4, -2, 2, -2, 3, 0, 4, -1, 2, -3, -3, -1, 2, 8, 3, 1, 1, -3, -1, 4, -5, 2, 0, 0, -1, 0, -2, 4, 0, 0, -2, 0, -2, -2, 3, 0, -4, 2, 3, -1, 2, -3, 0, -6, -1, 0, 1, 2, 6, 4, 0, 6, -4, 0, 2, 1, -4, -1, 2, 1, -4, -3, 0, -2, 2, -4, -5, -1, 3, 2, -1, 0, -1, 1, 1, 5, -3, 4, -2, 6, 0, 2, 1, 6, 0, -4, 0, 3, -3, -1, -2, 0, -2, -1, -2, 3, 2, -2, 1, 2, -4, -4, -1, 0, 1, 1, 0, 4, 1, 1, 0, -1, -4, -4, -5, 1, 1, -1, 3, -2, 3, -2, -2, 0, -1, -7, 1, 1, 1, -3, 3, -1, -4, 7, 1, -1, -2, 3, -1, -4, 4, -2, -1, -1, -2, 4, 2, 0, -6, 1, 2, 0, 4, 0, 7, -1, 3, 2, -5, 3, -4, 3, 2, 3, 1, -4, -2, 1, -2, -2, 1, -6, 1, 4, -1, -4, 0, 2, 1, 1, -4, -1, 1, -4, 2, -2, 0, -2, -1, -5, 2, 0, 1, -4, 2, -4, -5, -3, -6, -2, 4, -1, 0, -3, 2, -3, 2, 7, 0, 3, 0, 0, 5, 4, 3, 1, -3, 0, 2, 3, 0, 1, -1, 0, 3, 3, 5, 1, -2, 1, 2, -3, 0, 3, 0, -4, -2, 3, -1, -4, 5, -1, -3, -1, 1, 2, 1, -5, 3, -2, 2, -4, -3, 0, -4, -4, -2, 3, 0, 3, 0, -5, 0, 1, 2, 0, -4, 0, -1, -1, -2, 0, 2, 1, 0, 1, -1, 1, -3, -2, 0, -2, 3, -4, 2, 3, 1, 2, -1, 3, 4, -1, 3, -2, 0, 0, -3, 2, -2, 3, 0, 2, 3, 3, 6, -3, 2, 0, 2, 1, -2, -1, -1, -1, 3, -2, 1, 1, 3, 1, 0, 3, -1, 6, 1, -3, 1, 9, -4, -1, 0, 0, -1, 6, -6, -5, -3, 0, 4, -2, -1, -2, -4, 1, 0, 4, 1, 0, 8, 1, 2, 0, 1, 0, -2, -2, 2, -3, 4, 1, -2, 4, 0, 1, -2, 0, 8, -1, -1, -4, -1, 1, -2, -1, -5, -5, -2, -5, -1, 0, 0, -1, 0, -3, 3, 0, 6, -3, -2, 7, 2, 2, 0, 5, -1, -2, -4, -1, -1, 4, -2, -3, -3, 3, 2, 4, 1, -2, 6, 2, 0, 0, 0, -3, 0, 0, 1, 2, 5, -1, -6, -3, 1, -4, -5, 0, -3, 1, -2, 1, -4, -6, 2, 0, 6, -2, 3, -6, -6, 0, 1, -3, 4, 5, 4, 1, 1, 0, 3, 1, 2, -3, -3, -1, 2, 0, 0, 0, -2, 3, -1, -1, -3, 2, -2, -4, 6, 3, 1, -1, 0, -9, 0, -1, 0, -4, -4, 7, -1, -2, 1, 0, 0, -1, -1, -1, -2, 4, 4, 5, -3, -1, 1, 3, -1, 0, -2, 3, 1, -6, 1, 1, 2, 3, 4, 0, 1, -1, 4, -4, -3, 0, 4, 0, -4, 3, 0, 1, -3, 1, -1, 3, 2, -3, 0, 3, -2, 0, 3, 3, -1, 0, -3, 0, -3, -1, -4, -1, -4, 1, -4, 0};

double precomp_b20[MITAKA_D] = {14, -14, -3, -5, -13, 13, -10, 74, 37, -42, 15, 43, -44, 42, -43, -34, -2, -7, 14, -10, 3, -8, 6, -4, -60, 43, -14, -22, 20, -19, -70, -1, -5, 1, 15, 27, 10, 8, 16, 4, -12, 12, 1, -7, -10, -8, 38, 0, 18, -8, -18, 41, 13, -20, -35, 15, 8, 19, -7, -28, -3, 13, 54, 2, -33, 24, -18, 31, -28, 19, 21, -4, 46, 4, -3, -19, -2, 0, 72, -32, -28, -1, 29, -46, -31, 18, 20, -67, -20, -5, -27, -35, -32, 31, 35, -9, 15, -20, -39, -49, -33, -24, -23, -71, -24, -27, 24, -11, -22, 23, 1, 7, 11, 7, 7, -17, -20, -29, -49, -18, 17, -34, -42, 17, 35, -53, 11, -12, -5, -13, -33, -23, -18, -27, 5, 10, -12, 17, 62, 20, -9, 7, 14, 0, -15, 24, 16, 46, -40, -19, -15, -19, 10, 18, -37, 15, -8, -25, 17, 34, -39, 31, -42, -17, 8, 8, -10, -5, -41, -7, 3, -7, -20, -29, -21, 4, -42, 37, 16, 13, 1, -6, -26, -30, -57, -38, 4, -32, -14, 13, -29, 22, 15, -39, -20, -60, 20, 54, 30, -19, 5, 42, -1, -6, -4, -64, -35, -4, -37, 22, 7, -14, 3, -46, 43, -14, -27, -85, -4, 24, -69, -75, 4, 13, 39, -22, 24, -44, -11, 6, 52, 5, 13, 7, -7, 3, 24, 31, -25, 40, -50, -23, 22, -2, -57, -20, 11, -56, 6, -20, 0, -34, -45, 9, 18, -26, 8, 17, -20, 21, 32, 34, -33, 0, -29, -7, 22, -19, 60, -22, 7, -27, 11, -5, 9, -26, 24, -21, 4, -6, 9, -15, -32, 15, -15, 35, -11, 25, 16, 18, 4, -31, 20, 8, -10, -10, 7, -15, -6, 31, 13, -26, 2, 2, 0, 32, -33, -5, 25, -1, 3, 21, 0, 3, 22, -45, 26, 44, 19, 6, 61, -19, -29, 0, -7, -19, 10, -24, 20, -24, 7, -38, -3, -2, 8, -9, -26, -30, 12, -30, -1, 25, 9, 37, 41, -16, 14, 9, -11, -18, 0, 27, 43, -56, 6, 22, 2, -42, 20, 8, -39, 2, 9, 34, -17, -22, -15, 26, 25, 15, 11, -25, 19, 51, 37, 8, 32, -14, 21, 30, 67, -5, -6, 24, 43, 11, -42, -31, 30, -35, -3, 27, 46, 19, -24, 21, -2, -8, -5, -69, -18, 1, 38, -17, -20, 16, 23, 10, -24, -14, 29, 19, 41, 36, 42, -5, -5, -83, 41, -37, -1, 22, -31, -6, -8, -19, -29, -28, -11, -31, 1, -13, 8, -17, 1, 20, -13, 1, -7, -15, 6, -27, 7, 20, 55, -29, -40, 16, 0, 39, 28, 17, 17, 12, 12, 26, -14, -14, -16, -59, 48, 14, -5, -16, -13, 56, -6, -2, -24, 12, 84, 30, 51, -15, -20, 35, -44, 33, 26, -13, -3, 17, -45, 1, 5, -8, -33, -43, 21, -3, -1, -12, -35, -11, 27, 0, 33, -22, -9, 12, 14, 16, -22, -17, 47, -16, -40, 18, 22, 1, 2, 41, 4, -11, -2, -30, 44, 3, -20, -2, 28, -17, -4, 29, 50, -52, -9, 10, 15, -38, 37, -9, -30, 1, 18, 15, 9, 10, 3, -12, -24, -9, -20, -2, 20, -7, -16, 22, -17, 16, -28, 8, 14, 3, 39, -9, -2, -17, -30, 17, 28, -78, -2, -56, -43, 0, 23, -8, -39, -20, -17, -4, 5, 3, -18, 38, 0, 3, -39, 6, 14, -29, 11, -11, 19, -12, 66, 18, 14, 35, 10, -17, -63, 8, -6, -2, 32, 7, 46, 77, -13, -8, 14, -20, -63, 28, 10, -15, 38, -53, 46, 18, 5, 0, -24, 21, -5, 37, -79, 19, -7, 1, -10, -25, -5, -32, 20, -43, -12, -21, 51, 3, 18, -4, -1, 18, 10, -11, 94, -27, -42, -30, -51, 12, 19, -31, -46, -54, 7, -25, -15, -24, 3, -1, 11, -27, 27, 18, 3, -46, 21, -1, 79, -44, 6, 4, 27, -24, -19, -2, -10, 7, 10, 2, 43, 45, 59, 3, -9, -29, -46, 18, -14, 20, 9, 65, -16, -20, 27, 22, 50, 9, 16, 4, -5, -3, -16, 16, 16, -3, 6, 17, 62, 40, -19, -5, 6, -30, -12, -53, 2, -40, 23, 24, -38, 32, -21, 17, 74, -31, 14, -30, 3, 11, -1, 11, -3, 23, 29, -11, 2, -31, 17, 2, 6, 22, -34, -26, 4, -19, 53, 38, 5, 25, -23, 31, -17, -43, -13, -22, -24, 10, -25, -13, 30, -31, 54, 9, -26, 3, -36, 1, 24, 22, -3, -6, -15, -36, -6, 8, -45, -27, -29, -6, 11, 28, 58, 44, 35, -10, 44, 27, -17, -16, -15, -6, -11, -41, -37, -31, -20, 33, -19, 35, -17, -34, 11, -27, 33, 3, -6, 13, -31, 43, 37, -14, 5, 4, 0, 67, 25, 41, -6, -15, 18, 17, 18, -27, -33, 36, 38, 2, -1, 0, -28, -19, -16, -2, 34, 3, 16, 0, 59, -12, 6, -1, -36, 23, -51, -12, 31, -23, -22, 65, 43, 13, 32, -14, 17, 5, -41, -18, -26, -2, -18, -32, 13, 1, -1, -53, -14, 0, 23, -33, -10, -45, 27, 45, -30, 8, -38, -32, 48, 19, -15, -18, -12, -2, 31, 2, -12, 6, -28, -24, -25, 12, -4, -2, -17, -29, -22, -42, -50, -17, -2, -8, 30, -2, 6, 73, -13, 15, -5, 8, 38, -4, 22, 42, -14, 50, -47, 6, 42, 14, -21, -54, 5, 31, -17, 34, 7, -34, 70, -10, -2, 4, -12, -53, -46, -22, -21, 11, -9, 25, -40, 17, 1, 3, 23, -3, -5, 19, -7, -22, -31, -8, 15, -34, -45, 30, 15, 14, -46, -44, -6, -35, -12, 5, -26, 14, -40, 1, 4, -3, -13, -20, 29, 25, 3, -31, -18, -27, -19, -37, -27, 29, 28, -1, -49, -40, 3, -10, -19, -7, 22, 22, 2, 42, 17, -13, 2, 22, -13, -25, -3, -14, -3, 12, -10, -33, -9, -45, -9, -29, 1, 11, -8, -22, -46, -8, -44, -19, 14, 6, -4, -9, -31, -17, 24, -5, 10, 39, -21, 2};

double precomp_b21[MITAKA_D] = {-17, 27, 10, -3, -8, 13, 12, -16, -8, -18, -20, 5, 24, 64, 30, -3, 23, 10, 22, -41, -63, -45, 26, -30, 22, -24, 4, 0, 6, -19, 36, 28, -15, -23, -1, 61, 67, -22, 5, 6, 39, -52, -37, -3, 6, -7, -32, 40, 4, -1, -32, -14, 44, 19, -4, 6, -6, 11, 28, -13, -18, 11, -6, -5, -16, 21, -84, 30, -41, -41, 40, -15, -1, -42, 29, -6, 10, 1, -19, -49, 46, -44, 49, -21, -10, -9, 3, -32, -35, -11, 11, -23, 19, -2, 16, 14, -31, -6, 18, -32, 0, 16, 18, -21, -44, -23, 19, 11, 5, -35, -7, 4, -48, -2, -24, -36, 19, -3, 3, 13, -12, 79, 3, -11, -29, -6, -9, -47, -27, -1, 0, 19, -15, 9, -13, -6, 1, 5, 32, 39, -56, -20, -49, -3, -50, 7, 13, 4, -6, -55, -4, -6, -13, 7, 25, -3, 34, -10, 21, -4, 25, -60, -17, 81, -29, -9, 19, -22, -18, -21, -31, 35, 0, 32, -33, -9, -30, 19, -26, 8, 41, -35, -47, 24, 3, 33, -13, 29, 8, 23, 4, -46, -8, -5, -16, 12, -8, 6, -12, -33, -25, -8, -16, -2, -14, -15, -18, -22, 16, -33, 12, -73, -49, 2, -6, 10, 12, 42, 34, 3, 8, 26, -2, -36, 34, -54, -1, -30, 14, -13, -6, -1, -25, -19, -8, 4, -17, -33, -25, -10, 6, -9, 9, -37, -28, -15, -9, 28, 49, 15, 5, 14, 35, 9, 2, 36, -35, -7, 52, 10, 44, 42, 6, 3, -24, 0, 29, -10, -16, -59, -47, -9, -16, -45, 45, -17, 18, 17, -22, 47, -6, 21, 32, -15, 5, 2, 15, 10, -8, 0, 22, -20, -40, 9, -35, 34, -28, -1, -6, 46, 36, -12, -3, 18, -5, 46, -9, -16, -18, 12, -23, 46, 44, 21, -9, 17, -6, 19, 14, 8, 30, -13, 8, 8, 24, 15, 54, 15, 22, 15, 3, -9, 4, -26, -12, 19, -56, 39, -1, 4, 14, 1, -12, 0, -9, 13, -28, -15, -21, -5, 12, -30, 32, -53, -24, 1, -17, -40, 8, 9, -3, 9, -1, 12, 15, 18, -14, 41, 3, 62, 6, 18, -28, 6, 13, 22, -5, -52, -35, -41, 5, 7, 40, -11, 6, 34, 7, 30, 49, 2, -15, 12, -42, -2, 42, -74, 21, 4, 33, 22, 23, -8, 1, 27, -5, 2, 6, 15, -42, -20, 20, -31, 14, -11, -4, 13, 8, 8, 2, -22, 11, 22, -9, 25, -25, -1, -14, 18, 0, -34, -5, 41, -21, 26, -16, -33, -28, -40, 20, -46, 5, 23, 22, -18, 4, 45, -27, 6, -25, 18, -1, 12, 19, 21, 35, 6, 6, 11, -33, -23, -4, -9, 8, -21, -31, 16, 33, 8, 32, -2, 19, 15, 8, 3, -48, -47, -9, 51, 47, -67, -49, 39, 13, 14, 3, -21, -3, -14, 8, 13, -28, -1, 1, 7, -13, -18, 41, -22, -33, 18, -26, 22, -5, -17, 49, 49, 64, 10, -19, 23, 14, -40, -23, -29, 19, -38, -12, -19, 52, -30, 16, -30, 8, 22, 19, -29, 12, 37, 41, 30, 36, -11, -26, 18, 3, -23, 7, 3, -59, 2, 29, -20, -12, -35, 21, 14, 2, -5, 17, 2, -19, 22, -5, -18, -8, 3, -41, 12, -29, 54, -5, -13, 28, -2, 18, -19, -4, -36, 25, -1, -12, -18, 22, 47, -18, -14, 2, 21, -16, -49, -38, -15, -15, -7, -42, -8, 34, -12, -20, 0, 16, 6, 14, 38, -5, 11, 2, 4, -14, 40, -31, 21, -16, -24, 1, -25, 40, 8, -24, 32, 16, -26, 20, 24, 1, 0, -55, 33, 20, -33, 9, 40, 54, 43, -15, -35, 28, 43, -15, -29, -41, -44, 22, -2, 45, -1, 23, 3, 45, -5, -8, 3, -11, -35, -24, 29, 19, 4, -38, -9, 37, 39, -13, -9, -5, 9, -11, 9, 1, 14, 31, -41, 53, -35, 8, 9, -30, -14, -8, -3, 1, -16, 13, -1, -5, 0, -3, 12, -33, -3, 2, 2, 4, -10, -5, 0, -39, -19, 4, 10, 22, -4, -7, -42, 29, -11, -50, 10, 16, -5, 1, -41, 49, -9, 0, 19, -45, -39, -10, 16, -12, 20, 28, -11, 43, 23, -2, -13, -4, -32, -9, -28, 22, -30, -8, -12, -36, 2, -37, 38, 44, 11, 30, 13, 15, 21, 23, 25, -28, -32, 1, 18, 16, -7, -38, -20, -29, -38, -47, -11, 6, 15, -50, 5, 34, -23, 20, -71, 54, 26, 17, 6, 8, -43, 42, 35, 12, 22, -20, 0, -34, -2, -11, -50, -22, 8, 29, 3, 26, 13, -14, -31, -3, 18, -20, -20, -31, 8, 11, 14, -28, -25, 33, 29, 14, -35, -13, 13, 40, 12, -49, -2, -33, 1, -16, 7, 26, -13, -36, 10, 6, 9, -17, -15, -28, 2, 9, 89, 7, -35, -3, -19, 48, -18, -37, -5, 5, -10, 57, -16, -28, -6, 3, 17, -37, 28, -26, -47, -3, -40, 3, 0, -33, -66, -4, -8, -1, -66, -12, -12, 17, 47, -6, 24, -1, 46, 11, 18, 38, -25, 39, 16, -10, 15, -6, 53, -25, -20, 8, 12, -5, -21, -37, 2, -3, 20, 38, -49, 9, 25, -39, 21, 25, -33, 21, -47, 26, -14, -39, -35, -28, 37, -47, 4, -2, -7, -5, -4, -29, -5, 16, -17, -8, -18, 28, -7, 22, -3, -2, -20, -23, 7, 4, 9, -15, -3, 17, -16, -23, 35, 7, 19, -59, -22, 15, 11, 23, -31, -30, 15, 20, 2, 1, 33, -43, -3, 38, 53, -66, -10, -28, -17, 5, 11, 53, 14, -23, 10, 57, -47, -30, -3, -3, 11, -23, 14, -10, 37, -19, -17, 57, -26, 6, 29, 12, -8, -22, 3, 17, -13, 31, 47, -27, -26, 8, -9, -27, 23, -24, -8, -23, -1, 6, 16, -43, -14, -60, -13, -1, 3, -10, -79, -2, -13, 19, 1, -76, 92, 13, 11, 44, -6, 0, 1, -32, 15, 2, -11, -23, -20, 33, 26, 1, -32, 1, 34, -27, -28, -18, -26, 18, 73, 9, -7};

/* Precomputed corresponding PK */
double precomp_h[MITAKA_D] = {11400, 3645, 8979, 8185, 1880, 3800, 3679, 9598, 6583, 7687, 8960, 11182, 6491, 8565, 5385, 1432, 1098, 8049, 1920, 11945, 5150, 2623, 4491, 1824, 1863, 11685, 10638, 5057, 3189, 3322, 4597, 1393, 10429, 10678, 4493, 5282, 9819, 1461, 4492, 5388, 10835, 3915, 8955, 2609, 1603, 3763, 9683, 8250, 616, 6030, 799, 2296, 11355, 2892, 4180, 203, 6137, 10525, 5441, 4349, 6604, 1563, 11953, 11516, 9696, 11698, 3494, 7281, 7138, 3288, 11628, 4871, 1259, 9600, 2728, 2505, 5628, 8757, 10706, 6054, 4422, 9724, 4032, 3297, 9944, 1503, 7630, 734, 7846, 8535, 10306, 6520, 6354, 2128, 10563, 5688, 10965, 7820, 10337, 3301, 8390, 3850, 2737, 896, 9404, 7347, 5295, 4374, 5968, 723, 8375, 474, 10370, 9856, 524, 3213, 5417, 11773, 308, 3972, 11005, 4869, 6404, 917, 708, 9607, 7909, 6598, 9160, 883, 8818, 11394, 805, 1130, 1566, 3060, 12058, 9505, 8738, 5292, 1105, 4023, 31, 8396, 4064, 5142, 7954, 11497, 5606, 7529, 4563, 11475, 10578, 5457, 8899, 281, 8335, 11095, 1219, 3492, 3435, 1954, 3386, 8397, 1161, 12136, 2093, 9599, 1026, 3340, 6318, 5929, 9336, 8620, 4071, 1735, 9909, 10889, 3156, 2593, 12230, 3347, 551, 12228, 5699, 12263, 8431, 80, 6521, 5768, 5887, 979, 765, 8977, 4560, 731, 2684, 3640, 10118, 2167, 6534, 4866, 11878, 784, 9787, 2007, 10737, 8585, 8118, 2596, 2351, 1197, 2566, 8990, 6972, 9571, 553, 7147, 11987, 3428, 5915, 11237, 3980, 9826, 2847, 2044, 10918, 1688, 7656, 9827, 5769, 6134, 3572, 649, 2494, 11223, 843, 11361, 11392, 255, 9250, 8151, 4687, 10920, 4600, 253, 3472, 556, 2803, 5909, 5342, 2961, 9841, 7707, 7215, 4488, 1383, 6119, 10694, 1573, 1065, 7298, 6541, 10880, 3748, 2546, 2964, 5522, 9899, 6818, 1005, 3030, 182, 127, 7967, 2369, 2685, 1011, 7010, 4236, 10434, 1436, 7816, 2400, 3817, 7112, 1422, 4919, 355, 2740, 6375, 7558, 3424, 10450, 6453, 11650, 9396, 6130, 9919, 8569, 4261, 7440, 6869, 10680, 9704, 10778, 10593, 9849, 9150, 10946, 11109, 4984, 8056, 1121, 868, 10501, 5131, 3010, 6529, 7304, 5587, 5130, 903, 7228, 10813, 2993, 1620, 7271, 6559, 5219, 4478, 2280, 4912, 735, 5380, 3318, 8699, 5481, 3637, 924, 7288, 7406, 1302, 471, 11211, 3279, 11486, 3326, 7108, 11599, 8343, 7354, 7667, 6567, 926, 7962, 7331, 12222, 4599, 11216, 2008, 694, 4055, 1903, 6722, 8641, 11713, 6201, 5118, 10986, 2897, 10514, 11396, 8086, 10809, 6581, 11325, 9263, 311, 3709, 8977, 8040, 10563, 12072, 4230, 4788, 3640, 3207, 7156, 5570, 12192, 10707, 11972, 3568, 5558, 5460, 3931, 209, 8421, 9185, 1472, 6988, 6703, 7356, 4214, 4325, 1420, 6650, 3636, 7621, 4072, 185, 1041, 1719, 7474, 62, 11530, 9938, 5868, 5466, 10607, 2060, 988, 7236, 357, 7894, 5733, 3470, 8450, 11369, 10729, 5244, 9131, 10306, 11356, 3223, 7081, 7723, 10930, 5788, 5002, 1633, 8920, 6345, 10317, 7078, 10944, 1168, 9426, 2480, 10334, 9017, 8025, 80, 79, 1249, 8862, 1828, 921, 4269, 6774, 5655, 9289, 7345, 9166, 7980, 10542, 3660, 1485, 6837, 2887, 7798, 4669, 5271, 3691, 5671, 3278, 6269, 5499, 1915, 2042, 2276, 11359, 1862, 9802, 2346, 10704, 1017, 7462, 2603, 11165, 575, 9331, 7803, 9206, 10770, 1602, 4557, 3023, 414, 7634, 10335, 1418, 1422, 3351, 1378, 6265, 2672, 11868, 11018, 10111, 9595, 9794, 10145, 11011, 4266, 6790, 1452, 8570, 11029, 6936, 1238, 12232, 5556, 978, 12054, 11531, 12075, 10106, 2986, 6729, 12027, 3253, 8605, 3231, 9828, 3070, 6071, 7361, 4649, 1659, 11309, 6329, 8442, 5014, 8257, 759, 5543, 10714, 11050, 6655, 4281, 8496, 10111, 2784, 807, 6585, 9682, 2449, 7629, 3722, 9055, 9251, 4253, 8636, 8858, 9194, 9582, 4506, 8173, 11665, 10779, 4184, 372, 5143, 11796, 5170, 2655, 11959, 3639, 1978, 9047, 11881, 7878, 4217, 9341, 8336, 11778, 1405, 1621, 4438, 11690, 2945, 2047, 7793, 4362, 10134, 3560, 9785, 11993, 2826, 2311, 17, 4802, 5340, 2784, 2263, 12097, 9816, 2883, 101, 11361, 3056, 6907, 10199, 11254, 6070, 8073, 4502, 73, 9876, 8238, 610, 6586, 11742, 5388, 7965, 8582, 10994, 11182, 6195, 6277, 12205, 7104, 6204, 6023, 6309, 11477, 7327, 15, 4759, 9626, 1938, 319, 6795, 6141, 3652, 11521, 9362, 9093, 11277, 10827, 6845, 11027, 11064, 5509, 1889, 8578, 1344, 9564, 8349, 6406, 4816, 806, 11496, 12158, 9747, 4566, 10808, 8706, 1541, 4777, 10326, 1740, 7169, 7062, 1315, 3913, 9483, 8150, 5486, 8168, 10163, 9323, 190, 11160, 7234, 897, 1172, 12103, 975, 1782, 3125, 9273, 9367, 10467, 7489, 1667, 8580, 1376, 8470, 4703, 12155, 7318, 6225, 3916, 9790, 2617, 8194, 2849, 8129, 4106, 913, 3375, 10568, 2929, 9908, 6216, 9885, 6082, 8551, 889, 9889, 4573, 11917, 6433, 1488, 899, 9713, 11051, 7223, 7474, 2529, 5982, 11183, 3640, 2707, 8728, 1284, 3941, 2195, 10133, 10172, 9564, 7261, 1038, 2084, 7294, 6780, 635, 10189, 4008, 1530, 3161, 659, 2779, 7594, 12191, 8634, 5664, 698, 11322, 5152, 6373, 7567, 340, 8363, 11145, 8596, 1176, 10545, 6412, 4421, 10017, 5625, 1218, 9559, 4105, 8253, 6306, 11194, 5647, 9131, 11468, 2005, 1001, 787, 4938, 10197, 3259, 10780, 11763, 11736, 11525, 4040, 1480, 28, 11697, 5308, 7010, 1605, 6453, 11261, 10990, 1877, 11259, 1477, 607, 921, 3396, 11772, 9517, 7107, 500, 7065, 6846, 8400, 6589, 3971, 10049, 1769, 8771, 2500, 11885, 4060, 1007, 12029, 6069, 4657, 9002, 3694, 1787, 10818, 9358, 10691, 9852, 1568, 6534, 7215, 2930, 7912, 10410, 3444, 9266, 7835, 3972, 5066, 4135, 6279, 6837, 2183, 3422, 584, 10074, 3138, 11351, 9390, 2564, 4115, 7664, 7553, 53, 7477, 30, 7083, 12114, 10894, 6816, 8264, 3169, 6190, 3452, 286, 3017, 11190, 2576, 9248, 4964, 12068, 2529, 2203, 2807, 1209, 4451, 8992, 1415, 9008, 7042, 6632, 8445, 5358, 3246, 462, 10616, 1048, 9017, 1494, 9815, 2087, 2320, 5280, 12029, 9747, 9568, 1359, 2478, 8525, 7583, 2236, 11061, 11699, 939, 7031, 8657, 9930, 10397, 9408, 4709, 5715, 11065, 7558, 5288, 405, 9544, 4116, 7113, 10871, 10391, 10109, 9142, 10767, 4207, 10664, 7466, 993, 10431, 6261, 2703, 8701, 2709, 4450, 11481, 9525, 6331, 9232, 1160, 97, 8250, 2576, 395, 4969, 7866, 7760, 119, 3277, 9733, 3522, 3304, 2394, 2658, 1191, 2324, 2216, 4506, 4359, 4805, 2544, 706, 9782, 9623, 6912, 3087, 2456, 3685, 11257, 8954, 7943, 6268, 1409, 6324, 8255, 1176, 11376, 5961, 11799, 1034, 12227, 7086, 10390, 9677, 2110, 657, 588, 9478, 9916, 707, 9613, 2239, 9316, 10963, 4253, 6177, 6155, 3922, 5417, 12263, 8336, 12207, 2284, 8959, 7756, 6962, 1178, 4447, 10358, 1742, 5304, 4315, 3174, 11252, 10200, 798, 4, 9392};


#endif





void load_B(secret_key* sk){
  for(int i=0; i < MITAKA_D; ++i){
    (sk->b10).coeffs[i].v = precomp_b10[i];
    (sk->b11).coeffs[i].v = precomp_b11[i];
    (sk->b20).coeffs[i].v = precomp_b20[i];
    (sk->b21).coeffs[i].v = precomp_b21[i];
  }
}


void precomp_GSO(secret_key* sk){

  poly temp1, temp2, temp3;

  for(int i=0; i < MITAKA_D; ++i){
    (sk->GSO_b10).coeffs[i].v = (sk->b10).coeffs[i].v;
    (sk->GSO_b11).coeffs[i].v = (sk->b11).coeffs[i].v;
    (sk->GSO_b20).coeffs[i].v = (sk->b20).coeffs[i].v;
    (sk->GSO_b21).coeffs[i].v = (sk->b21).coeffs[i].v;
  }

  
  set_poly(&temp1, &(sk->b20)); set_poly(&temp2, &(sk->b21));

  FFT_mul_adj(&temp1, &(sk->b10)); FFT_mul_adj(&temp2, &(sk->b11));
  poly_add(&temp1, &temp2); // temp1 = <b1, b2> 
  
  set_poly(&temp2, &(sk->b10)); set_poly(&temp3, &(sk->b11));

  FFT_mul_selfadj(&temp2); FFT_mul_selfadj(&temp3);
  poly_add(&temp2, &temp3); // temp2 = <b1, b1>
  
  poly_div_FFT(&temp1, &temp2);
  set_poly(&temp2, &temp1); // temp2 = temp1 = <b1, b2>/<b1, b1>

  pointwise_mul(&temp1, &(sk->GSO_b10));
  pointwise_mul(&temp2, &(sk->GSO_b11)); // [temp1,temp2] = (<b1, b2>/<b1, b1>) * ~b1



  poly_sub(&(sk->GSO_b20), &temp1); poly_sub(&(sk->GSO_b21), &temp2);
}

void precomp_sigma(secret_key* sk){



  poly temp1, temp2, poly_r_square;

  for(int i=0; i < MITAKA_D/2; ++i) {
    (sk->sigma1).coeffs[i].v = SIGMA_SQUARE;
    (sk->sigma2).coeffs[i].v = SIGMA_SQUARE;
    poly_r_square.coeffs[i].v = R_SQUARE;

  }
  for(int i=MITAKA_D/2; i < MITAKA_D; ++i) {
    poly_r_square.coeffs[i].v = 0;
    (sk->sigma1).coeffs[i].v = 0;
    (sk->sigma2).coeffs[i].v = 0;
  }


  set_poly(&temp1, &(sk->GSO_b10)); set_poly(&temp2, &(sk->GSO_b11));

  FFT_mul_selfadj(&temp1); FFT_mul_selfadj(&temp2);
  poly_add(&temp1, &temp2);

  poly_div_FFT(&(sk->sigma1), &temp1);
  poly_sub(&(sk->sigma1), &poly_r_square);

  for(int i=0; i < MITAKA_D; ++i) (sk->sigma1).coeffs[i].v = sqrt((sk->sigma1).coeffs[i].v);


  set_poly(&temp1, &(sk->GSO_b20)); set_poly(&temp2, &(sk->GSO_b21));

  FFT_mul_selfadj(&temp1); FFT_mul_selfadj(&temp2);
  poly_add(&temp1, &temp2);
  poly_div_FFT(&(sk->sigma2), &temp1);
  poly_sub(&(sk->sigma2), &poly_r_square);
  for(int i=0; i < MITAKA_D; ++i) (sk->sigma2).coeffs[i].v = sqrt((sk->sigma2).coeffs[i].v);

}

void precomp_beta_hat(secret_key* sk){

  poly temp1, temp2;
  // beta1
  set_poly(&temp1, &(sk->GSO_b10)); set_poly(&temp2, &(sk->GSO_b11));

  FFT_mul_selfadj(&temp1); FFT_mul_selfadj(&temp2);
  poly_add(&temp1, &temp2);

  set_poly(&(sk->beta10), &(sk->GSO_b10));
  set_poly(&(sk->beta11), &(sk->GSO_b11));
  FFT_adj(&(sk->beta10)); FFT_adj(&(sk->beta11));
  poly_div_FFT(&(sk->beta10), &temp1); poly_div_FFT(&(sk->beta11), &temp1);



  // beta2
  set_poly(&temp1, &(sk->GSO_b20)); set_poly(&temp2, &(sk->GSO_b21));

  FFT_mul_selfadj(&temp1); FFT_mul_selfadj(&temp2);
  poly_add(&temp1, &temp2);

  set_poly(&(sk->beta20), &(sk->GSO_b20));
  set_poly(&(sk->beta21), &(sk->GSO_b21));
  FFT_adj(&(sk->beta20)); FFT_adj(&(sk->beta21));
  poly_div_FFT(&(sk->beta20), &temp1); poly_div_FFT(&(sk->beta21), &temp1);

}

void precomp(secret_key* sk){
  load_B(sk);
  FFT(&(sk->b10)); FFT(&(sk->b11)); FFT(&(sk->b20)); FFT(&(sk->b21));
  precomp_GSO(sk);
  precomp_sigma(sk);
  precomp_beta_hat(sk); 
  //print_sk(sk);
}

void load_pk(public_key* pk){
  for(int i=0; i < MITAKA_D; ++i){
    (pk->h).coeffs[i].v = precomp_h[i];
  }
  FFT(&(pk->h));
}